---
layout: post
title: 인공지능 & Pytorch_입문(Backpropagation)
date: 2021-12-06 21:24 
last_modified_at: 2021-12-06 21:24
tags: [인공지능,pytorch]
categories: [인공지능]
toc:  false
---

* #### python을 기본적으로 사용합니다  
* #### Gpu을 사용하기 위하여 Goole에서 이용할 수 있는 Colab을 이용해서 실행

## 인공지능을 위한 pytorch 배우기 


### 2.Backpropagation(역전파) : 인공 신경망을 최적화 하는 과정에서 미분은 필수적인 요소이다 pytorch는 최적화 과정인 역전파(Backpropagation)를 쉽게 할 수 있도록 <u>자동 미분 계산</u>을 제공한다.

#### __2.1 자동 미분 준비__

```python
#라이브러리 불러오기
import torch
# requires_grad=True는 해당 텐서를 기준으로 모든 연산들을 추적할 수 있게 하는 옵션이다.
x = torch.ones(2,2, requires_grad=True) # 2x2 tensor 생성 자동미분
print(x)
```

```python
y = x+1 # y는 x에 관한 식
z = 2*y**2 # z는 y에 관한 식
result = z.mean() # result는 z에 관한 식이다.
print("y:", y)
print("z:", z)
print("Result:", result)
# grad_fn=..은 추적이 잘 되고 있다는 뜻
```

#### __2.2 역전파__  

```python
result.backward() # result를 기준으로 역전파 진행
# 위에 식을 역으로 써내려 가보면
# result = (z_1 +... z_4)/4 → x는 2X2행렬이므로 총 4개의 원소이므로 
# z_i = 2 y_i **2 
# z_i = 2(x_i+1) **2
# d(result)/dx_i = x_i + 1

print(x)
print(x.grad)  
# backward()가 선언 된 변수를 기준으로 미분 d(result)/dx를 계산
# d(result)/dx_i = x_i + 1

```

### ![d(result)/dx 이미지](/home/jypark/Git/Blog/_posts/오류역전파.jpg) 그림을 보면 코드를 이해하기 쉽다!


#### __3.1 데이터 불러오기__ : 머신러닝의 근원은 데이터이다. 따라서 데이터의 수집,가공,사용 방법에 따라 모델 성능이 크게 달라질 수 있으며 데이터의 형태는 매우 다양하기 때문에 데이터 전처리를 가장 중요한 단계 중 하나이다.

```python
import torch # 기본 라이브러리
import torchvision # 이미지 관련 라이브러리
import torchvision.transforms as tr # 이미지 전처리 기능들을 제공하는 라이브러리
from torch.utils.data import DataLoader, dataset # 데이터를 모델에 사용할 수 있도록 정리해 주는 라이브러리
import numpy as np # 넘파이 기본 라이브러리
```

#### 3.1 Pytorch 제공 Data 사용

```python
# https://pytorch.org/docs/stable/torchvision/transforms.html에서 여러 전처리 방법 확인 가능.
# tr.Compose 내에 원하는 전처리를 넣어준다.

transf = tr.Compose([tr.Resize(16), tr.ToTensor()]) # 16x16으로 resize 이후 Tensor 타입으로 변환

# Transforms on PIL Image
# Pad, Grayscale, RandomCrop, Normalize ..
# Transfroms on torch. *Tensor - tensor image
# torchvision.transforms.ToPILImage(mode=None)...
# ...
#
```